!function(e,t,n,r,a){var l="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},s="function"==typeof l.parcelRequire5ce4&&l.parcelRequire5ce4,u=s.cache||{},i="undefined"!=typeof module&&"function"==typeof module.require&&module.require.bind(module);function o(t,n){if(!u[t]){if(!e[t]){var r="function"==typeof l.parcelRequire5ce4&&l.parcelRequire5ce4;if(!n&&r)return r(t,!0);if(s)return s(t,!0);if(i&&"string"==typeof t)return i(t);var a=new Error("Cannot find module '"+t+"'");throw a.code="MODULE_NOT_FOUND",a}d.resolve=function(n){return e[t][1][n]||n},d.cache={};var c=u[t]=new o.Module(t);e[t][0].call(c.exports,d,c,c.exports,this)}return u[t].exports;function d(e){return o(d.resolve(e))}}o.isParcelRequire=!0,o.Module=function(e){this.id=e,this.bundle=o,this.exports={}},o.modules=e,o.cache=u,o.parent=s,o.register=function(t,n){e[t]=[function(e,t){t.exports=n},{}]},Object.defineProperty(o,"root",{get:function(){return l.parcelRequire5ce4}}),l.parcelRequire5ce4=o;for(var c=0;c<t.length;c++)o(t[c]);var d=o(n);"object"==typeof exports&&"undefined"!=typeof module?module.exports=d:"function"==typeof define&&define.amd&&define((function(){return d}))}({"2VTMI":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.router=void 0;var a=e("./pages/login"),l=r(e("./pages/login/index.tmpl")),s=e("./pages/signup"),u=r(e("./pages/signup/index.tmpl")),i=e("./pages/profile"),o=r(e("./pages/profile/index.tmpl")),c=e("./pages/messenger"),d=r(e("./pages/messenger/index.tmpl")),f=r(e("./pages/errorPage")),p=r(e("./pages/errorPage/index.tmpl"));e("./index.scss");var v=r(e("./utils/classes/Router")),h=e("./store/Store"),m=r(e("./components/Messages")),b=r(e("./components/popups/ChatUserListPopup")),y=r(e("./components/popups/ChatUserAddPopup")),g={"/":{Class:c.Messenger,props:c.messengerProps,value:null,tmpl:d.default,isProtected:!0,listenedStoreField:["chats","activeChat","updateMessenger"]},"/login":{Class:a.Login,props:a.loginProps,value:null,tmpl:l.default,isProtected:!1,listenedStoreField:[]},"/sign-up":{Class:s.Signup,props:s.signupProps,value:null,tmpl:u.default,isProtected:!1,listenedStoreField:[]},"/settings":{Class:i.Profile,props:i.profileProps,value:null,tmpl:o.default,isProtected:!0,listenedStoreField:["userData"]}},k=new v.default("#root");n.router=k,Object.keys(g).forEach((function(e){var t=g[e],n=t.Class,r=t.props,a=t.tmpl,l=t.isProtected,s=t.listenedStoreField,u=new n(r,a);k.use(e,u,l),s.forEach((function(e){var t=u.setProps.bind(u);h.storeEventBus.on(e,t)}))})),h.storeEventBus.on("activeChatMessages",m.default.setProps.bind(m.default)),h.storeEventBus.on("activeChatUsers",b.default.setProps.bind(b.default)),h.storeEventBus.on("searchUserList",y.default.setProps.bind(y.default)),k.use("errorPage",new f.default({error:{code:"404",message:"Страница не существует"}},p.default),!1),k.start()},{"./pages/login":"3nYzq","./pages/login/index.tmpl":"6l5XE","./pages/signup":"tOoNo","./pages/signup/index.tmpl":"5n8U4","./pages/profile":"43pLp","./pages/profile/index.tmpl":"7IFjV","./pages/messenger":"1Mk1Z","./pages/messenger/index.tmpl":"d2HmX","./pages/errorPage":"1zU4o","./pages/errorPage/index.tmpl":"6FZfd","./index.scss":"5iJih","./utils/classes/Router":"2GTux","./store/Store":"4xi7r","./components/Messages":"2M7ZJ","./components/popups/ChatUserListPopup":"2TlYL","./components/popups/ChatUserAddPopup":"33Q4c"}],"3nYzq":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.loginProps=n.Login=n.submitButton=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/inherits")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),u=r(e("@babel/runtime/helpers/getPrototypeOf")),i=r(e("../../components/DefaultInput/index")),o=r(e("../../components/DefaultInput/index.tmpl")),c=r(e("../../components/Button/index")),d=r(e("../../components/Button/index.tmpl")),f=r(e("../../utils/classes/Validation")),p=r(e("../../modules/Form")),v=e("../../index"),h=r(e("../../controllers/AuthController")),m=r(e("../../utils/functions/getObjFromFormData"));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var y=new i.default({label:"Login",type:"text",name:"login",errorText:"Wrong login",events:[{type:"blur",element:"input",callback:function(e){var t=e.target;new f.default(t.value).minLength(4).isValid?y.setValid():y.setValidError()}}]},o.default),g=new i.default({label:"Password",type:"password",name:"password",errorText:"Wrong password",events:[{type:"blur",element:"input",callback:function(){g.setValid()}}]},o.default),k=new c.default({attributes:[{element:"root",disabled:{type:"set",value:!0},className:{type:"add",value:"disabled"}}],type:"submit",text:"Login"},d.default);n.submitButton=k;var C=function(e){(0,l.default)(n,e);var t=b(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return n}(p.default);n.Login=C;var O={events:[{type:"submit",element:"form",callback:function(e){var t=e.target;e.preventDefault(),h.default.signIn((0,m.default)(new FormData(t))),t.reset()}},{type:"click",element:"[data-path]",callback:function(e){var t=e.target.dataset.path;v.router.go(t)}}],components:{loginInput:y,passwordInput:g,submitButton:k}};n.loginProps=O},{"../../components/DefaultInput/index":"5xxXy","../../components/DefaultInput/index.tmpl":"7CCL9","../../components/Button/index":"o32bC","../../components/Button/index.tmpl":"30wYB","../../utils/classes/Validation":"5y01V","../../modules/Form":"3PPs5","../../index":"2VTMI","../../controllers/AuthController":"4WQRY","../../utils/functions/getObjFromFormData":"5kw0O"}],"5xxXy":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=r(e("@babel/runtime/helpers/inherits")),u=r(e("@babel/runtime/helpers/possibleConstructorReturn")),i=r(e("@babel/runtime/helpers/getPrototypeOf"));function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,i.default)(e);if(t){var a=(0,i.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var c=function(e){(0,s.default)(n,e);var t=o(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return(0,l.default)(n,[{key:"input",get:function(){return this.element.querySelector("input")}},{key:"setValidError",value:function(){var e;this.input.dataset.valid="false",null===(e=this.element.querySelector("[data-validation-error]"))||void 0===e||e.classList.add("visible"),this.props.checkFormValid()}},{key:"setValid",value:function(){var e;this.input.dataset.valid="true",null===(e=this.element.querySelector("[data-validation-error]"))||void 0===e||e.classList.remove("visible"),this.props.checkFormValid()}}]),n}(r(e("../../modules/Block/Block")).default);n.default=c},{"../../modules/Block/Block":"GBKa8"}],GBKa8:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a,l=r(e("@babel/runtime/helpers/toConsumableArray")),s=r(e("@babel/runtime/helpers/typeof")),u=r(e("@babel/runtime/helpers/classCallCheck")),i=r(e("@babel/runtime/helpers/createClass")),o=r(e("@babel/runtime/helpers/defineProperty")),c=r(e("../../utils/classes/EventBus")),d=r(e("../../utils/classes/Templator"));function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){(0,o.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}!function(e){e.INIT="init",e.FLOW_CDM="flow:component-did-mount",e.FLOW_CDU="flow:component-did-update",e.FLOW_RENDER="flow:render"}(a||(a={}));var v=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;(0,u.default)(this,e),(0,o.default)(this,"props",void 0),(0,o.default)(this,"_meta",void 0),(0,o.default)(this,"eventBus",void 0),(0,o.default)(this,"_boundEvents",void 0),(0,o.default)(this,"_element",void 0),(0,o.default)(this,"setProps",(function(e){e&&Object.assign(t.props,p({},e))})),this._boundEvents=[],this.eventBus=new c.default,this._meta={tmpl:r,props:n},this.props=this._makeProxy(p({},n)),this._registerEvents(),this.eventBus.emit(a.INIT)}return(0,i.default)(e,[{key:"element",get:function(){return this._element}},{key:"destroy",value:function(){this.element.remove()}},{key:"create",value:function(){this.eventBus.emit(a.INIT)}},{key:"getContent",value:function(){return this.element}},{key:"render",value:function(){return d.default.getCompiledChildren(this._meta.tmpl,this.props)}},{key:"componentDidMount",value:function(){}},{key:"init",value:function(){this._createResources(),this.eventBus.emit(a.FLOW_CDM)}},{key:"componentDidUpdate",value:function(e,t){return e!==t}},{key:"show",value:function(){this.getContent().classList.remove("hidden")}},{key:"hide",value:function(){this.getContent().classList.add("hidden")}},{key:"_registerEvents",value:function(){this.eventBus.on(a.INIT,this.init.bind(this)),this.eventBus.on(a.FLOW_CDM,this._componentDidMount.bind(this)),this.eventBus.on(a.FLOW_CDU,this._componentDidUpdate.bind(this)),this.eventBus.on(a.FLOW_RENDER,this._render.bind(this))}},{key:"_createResources",value:function(){this._element=d.default.getCompiledParent(this._meta.tmpl,this.props)}},{key:"_makeProxy",value:function(e){var t=this;return new Proxy(e,{get:function(e,t){var n=e[t];return"function"==typeof n?n.bind(e):n},set:function(e,n,r){return"object"===(0,s.default)(e[n])&&"events"===n?Object.assign(e[n],r):e[n]=r,t.eventBus.emit(a.FLOW_CDU,p({},e),e),!0},deleteProperty:function(){throw new Error("Нет доступа")}})}},{key:"_componentDidMount",value:function(){this.componentDidMount(),this.eventBus.emit(a.FLOW_RENDER)}},{key:"_componentDidUpdate",value:function(e,t){this.componentDidUpdate(e,t)&&this._render()}},{key:"addEvents",value:function(){var e=this;this._boundEvents.forEach((function(t){var n=t.type,r=t.element,a=t.callback;r&&("root"===r?e.element.addEventListener(n,a):e.element.querySelectorAll(r).forEach((function(e){e.addEventListener(n,a)})))}))}},{key:"removeEvents",value:function(){var e=this;this._boundEvents.forEach((function(t){var n=t.type,r=t.element,a=t.callback;r&&("root"===r?e.element.removeEventListener(n,a):e.element.querySelectorAll(r).forEach((function(e){e.removeEventListener(n,a)})))})),this.props.events&&(this._boundEvents=[],this.props.events.forEach((function(t){var n=t.type,r=t.element,a=t.callback;e._boundEvents.push({type:n,element:r,callback:a.bind(e)})})))}},{key:"setAttributes",value:function(e){if(void 0!==this.props.attributes)return this.props.attributes.forEach((function(t){var n=e;"root"!==t.element&&(n=e.querySelector(t.element)),null!==n&&Object.keys(t).forEach((function(e){if("element"!==e)if("className"===e){var r,a,l=null===(r=t[e])||void 0===r?void 0:r.type,s=null===(a=t[e])||void 0===a?void 0:a.value;void 0!==l&&void 0!==s&&n.classList[l](s)}else{var u=t[e],i=u.type,o=u.value;"set"===i?n.setAttribute(e,o):"remove"===i&&n.removeAttribute(e)}}))})),e}},{key:"_render",value:function(){var e,t=this.render();t.length&&(this._element.innerHTML="",(e=this._element).append.apply(e,(0,l.default)(t)));this.removeEvents(),this.setAttributes(this._element),this.addEvents(),this.afterRender()}},{key:"forceUpdate",value:function(){this.eventBus.emit(a.INIT)}},{key:"afterRender",value:function(){}}]),e}();n.default=v},{"../../utils/classes/EventBus":"3ppPn","../../utils/classes/Templator":"6VyJz"}],"3ppPn":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=r(e("@babel/runtime/helpers/defineProperty")),u=function(){function e(){(0,a.default)(this,e),(0,s.default)(this,"listeners",void 0),this.listeners={}}return(0,l.default)(e,[{key:"on",value:function(e,t){this.listeners[e]||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"off",value:function(e,t){this.listeners[e]=this.listeners[e].filter((function(e){return e!==t}))}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.listeners[e]&&this.listeners[e].forEach((function(e){e.apply(void 0,n)}))}}]),e}();n.default=u},{}],"6VyJz":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/toConsumableArray")),l=r(e("../functions/get")),s={compile:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=/{{(.*?)}}/gi,r=e,a=Array.from(e.matchAll(n));return a.forEach((function(e){var n,a=e[1].trim(),s=(0,l.default)(t,a);if(a.includes(".time")){var u=new Date(s),i=new Date;n=u.toDateString()===i.toDateString()?new Date(s).toLocaleTimeString().slice(0,-3):new Date(s).toLocaleDateString()}else n=null==s?"":s;r=r.replace(new RegExp(e[0],"gi"),n)})),r},getCompiledParent:function(e,t){var n=this.compile(e,t),r=(new DOMParser).parseFromString(n,"text/html").body.children[0];return r.children.length&&(r.innerHTML=""),r},getCompiledChildren:function(e,t){return this.compileToHtml(e,t).children},compileToHtml:function(e,t){var n=e;n=this.compile(n,t);var r=(new DOMParser).parseFromString(n,"text/html").body.children[0];return t.components&&r.querySelectorAll("[data-component]").forEach((function(e){if(void 0!==t.components&&e instanceof HTMLElement){var n=t.components[e.dataset.component];if(void 0!==n)if(Array.isArray(n)){var r=document.createDocumentFragment();r.append.apply(r,(0,a.default)(n.map((function(e){return e.getContent()})))),e.replaceWith(r)}else e.replaceWith(n.getContent())}})),r}};n.default=s},{"../functions/get":"4191x"}],"4191x":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("./isPlainObject"));var l=function(e,t,n){var r=t.split("."),l=e[r[0]];if(void 0===l)return l;if((0,a.default)(l))for(var s=1;s<r.length;s++){if(void 0===l[r[s]]){l=n||void 0;break}l=l[r[s]]}return l};n.default=l},{"./isPlainObject":"4ImsX"}],"4ImsX":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/typeof"));var l=function(e){return"object"===(0,a.default)(e)&&null!==e&&e.constructor===Object&&"[object Object]"===Object.prototype.toString.call(e)};n.default=l},{}],"7CCL9":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="\n  <div class='input-wrap'>\n    <span class='label'>{{label}}</span>\n    <input data-valid='false' name='{{name}}' class='input' type='{{type}}' value=\"{{value}}\"/>\n    <span data-validation-error class='error'>{{errorText}}</span>\n  </div>"},{}],o32bC:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=r(e("@babel/runtime/helpers/inherits")),u=r(e("@babel/runtime/helpers/possibleConstructorReturn")),i=r(e("@babel/runtime/helpers/getPrototypeOf"));function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,i.default)(e);if(t){var a=(0,i.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var c=function(e){(0,s.default)(n,e);var t=o(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return(0,l.default)(n,[{key:"button",get:function(){return this.element.querySelector("button")}}]),n}(r(e("../../modules/Block/Block")).default);n.default=c},{"../../modules/Block/Block":"GBKa8"}],"30wYB":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="<button type='{{type}}' class='button'>{{text}}</button>"},{}],"5y01V":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.checkValidationByTemplate=function(e,t){var n,r=new f(t);switch(e){case"email":n=r.email().isValid;break;case"login":n=r.minLength(4).lettersOrNumbers().isValid;break;case"first_name":case"second_name":n=r.minLength(2).onlyLetters().isValid;break;case"phone":n=r.phone().isValid;break;case"password":n=r.minLength(6).lettersOrNumbers().isValid;break;default:n=!1}return n},n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=r(e("@babel/runtime/helpers/defineProperty")),u=/^[a-z]+$/i,i=/^\d+$/,o=/^(\s*)?(\+)?([- _():=+]?\d[- _():=+]?){10,14}(\s*)?$/,c=/^\S+@\S+\.\S+$/,d=/[0-9]/,f=function(){function e(t){(0,a.default)(this,e),(0,s.default)(this,"isValid",!0),(0,s.default)(this,"value",void 0),this.value=t}return(0,l.default)(e,[{key:"email",value:function(){return this.isValid=c.test(this.value)&&this.isValid,this}},{key:"required",value:function(){return this.isValid=!!this.value.length&&this.isValid,this}},{key:"maxLength",value:function(e){return this.isValid=this.value.length<=e&&this.isValid,this}},{key:"minLength",value:function(e){return this.isValid=this.value.length>=e&&this.isValid,this}},{key:"onlyLetters",value:function(){return this.isValid=u.test(this.value)&&this.isValid,this}},{key:"onlyNumbers",value:function(){return this.isValid=i.test(this.value)&&this.isValid,this}},{key:"phone",value:function(){return this.isValid=o.test(this.value)&&this.isValid,this}},{key:"lettersOrNumbers",value:function(){return this.isValid=d.test(this.value)&&this.isValid,this}}]),e}();var p=f;n.default=p},{}],"3PPs5":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=r(e("@babel/runtime/helpers/assertThisInitialized")),u=r(e("@babel/runtime/helpers/inherits")),i=r(e("@babel/runtime/helpers/possibleConstructorReturn")),o=r(e("@babel/runtime/helpers/getPrototypeOf"));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}var d=function(e){(0,u.default)(n,e);var t=c(n);function n(e,r){var l;return(0,a.default)(this,n),(l=t.call(this,e,r)).props.components&&Object.keys(l.props.components).forEach((function(e){if(void 0!==l.props.components){var t=l.props.components[e];Array.isArray(t)?t.forEach((function(e){e.setProps({checkFormValid:l.checkFormValid.bind((0,s.default)(l))})})):t.setProps({checkFormValid:l.checkFormValid.bind((0,s.default)(l))})}})),l}return(0,l.default)(n,[{key:"submitButton",get:function(){return this.element.querySelector("button")}},{key:"checkFormValid",value:function(){var e=this.element.querySelectorAll("input"),t=!0;e.forEach((function(e){t="true"===e.dataset.valid&&t})),t?(this.submitButton.classList.remove("disabled"),this.submitButton.removeAttribute("disabled")):(this.submitButton.classList.add("disabled"),this.submitButton.setAttribute("disabled","true"))}}]),n}(r(e("./Block/Block")).default);n.default=d},{"./Block/Block":"GBKa8"}],"4WQRY":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault"),a=e("@babel/runtime/helpers/typeof");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var l=r(e("@babel/runtime/helpers/defineProperty")),s=r(e("@babel/runtime/helpers/classCallCheck")),u=r(e("@babel/runtime/helpers/createClass")),i=r(e("../api/AuthApi")),o=e("../index"),c=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};var n=f(t);if(n&&n.has(e))return n.get(e);var r={},l=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in e)if("default"!==s&&Object.prototype.hasOwnProperty.call(e,s)){var u=l?Object.getOwnPropertyDescriptor(e,s):null;u&&(u.get||u.set)?Object.defineProperty(r,s,u):r[s]=e[s]}r.default=e,n&&n.set(e,r);return r}(e("../store/Store")),d=r(e("../utils/functions/deepEncodeHTML"));function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(f=function(e){return e?n:t})(e)}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var v=function(){function e(){(0,s.default)(this,e)}return(0,u.default)(e,null,[{key:"signUp",value:function(t){i.default.signUp(JSON.stringify((0,d.default)(t))).then((function(){e.getUser((function(){o.router.go("/")}))})).catch((function(e){var t=e,n=JSON.parse(t.response).reason;"Login already exists"===n&&alert(n)}))}},{key:"getUser",value:function(e){i.default.getUser().then((function(t){c.default.userData=(0,d.default)(JSON.parse(t.response)),void 0!==e&&e()})).catch((function(){c.default.userData=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},c.storeUserInitial.userData),o.router.go("/login")}))}},{key:"checkUserLoggedIn",value:function(){return i.default.getUser()}},{key:"signIn",value:function(t){i.default.signIn(JSON.stringify((0,d.default)(t))).then((function(t){"OK"===t.response&&e.getUser((function(){o.router.go("/")}))})).catch((function(t){var n=t,r=JSON.parse(n.response).reason;"User already in system"===r?e.getUser((function(){o.router.go("/")})):alert(r)}))}},{key:"logout",value:function(){i.default.logout().then((function(){o.router.go("/login")}))}}]),e}();n.default=v},{"../api/AuthApi":"5TsWN","../index":"2VTMI","../store/Store":"4xi7r","../utils/functions/deepEncodeHTML":"6EZWZ"}],"5TsWN":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/regenerator")),l=r(e("@babel/runtime/helpers/asyncToGenerator")),s=r(e("@babel/runtime/helpers/classCallCheck")),u=r(e("@babel/runtime/helpers/createClass")),i=new(r(e("../utils/classes/HTTP")).default)("https://ya-praktikum.tech/api/v2/auth"),o=function(){function e(){(0,s.default)(this,e)}var t,n,r;return(0,u.default)(e,null,[{key:"signUp",value:(r=(0,l.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.post("/signup",{data:t,withCredentials:!0,headers:{"content-type":"application/json"}}));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"signIn",value:function(e){return i.post("/signin",{data:e,withCredentials:!0,headers:{"content-type":"application/json"}})}},{key:"getUser",value:(n=(0,l.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.get("/user",{withCredentials:!0}));case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"logout",value:(t=(0,l.default)(a.default.mark((function e(){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.post("/logout",{withCredentials:!0,headers:{"content-type":"application/json"}}));case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})}]),e}();n.default=o},{"../utils/classes/HTTP":"1Cfkm"}],"1Cfkm":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/defineProperty")),s=r(e("../functions/queryStringify"));function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var o="GET",c="POST",d="PUT",f="DELETE",p=function e(t){var n=this;(0,a.default)(this,e),(0,l.default)(this,"url",void 0),(0,l.default)(this,"get",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.request(e,i(i({},t),{},{method:o}),t.timeout)})),(0,l.default)(this,"post",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.request(e,i(i({},t),{},{method:c}),t.timeout)})),(0,l.default)(this,"put",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.request(e,i(i({},t),{},{method:d}),t.timeout)})),(0,l.default)(this,"delete",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return n.request(e,i(i({},t),{},{method:f}),t.timeout)})),(0,l.default)(this,"request",(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3,a=t.headers,l=void 0===a?{}:a,u=t.method,i=t.data,c=t.withCredentials;return new Promise((function(t,a){if(u){var d=new XMLHttpRequest,f=u===o;d.withCredentials=!!c,d.open(u,f&&i?"".concat(n.url+e).concat((0,s.default)(i)):n.url+e),Object.keys(l).forEach((function(e){d.setRequestHeader(e,l[e])})),d.onload=function(){d.status>=200&&d.status<300?t(d):d.status>=400&&d.status<500&&a(d)},d.onabort=a,d.onerror=a,d.timeout=r,d.ontimeout=a,f||!i?d.send():d.send(i)}else a("No method")}))})),this.url=t};n.default=p},{"../functions/queryStringify":"5Kqjm"}],"5Kqjm":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/toConsumableArray")),l=r(e("@babel/runtime/helpers/slicedToArray")),s=r(e("./isPlainObject"));function u(e){return(0,s.default)(e)||Array.isArray(e)}function i(e,t){return t?"".concat(t,"[").concat(e,"]"):e}function o(e,t){for(var n=[],r=0,s=Object.entries(e);r<s.length;r++){var c=(0,l.default)(s[r],2),d=c[0],f=c[1];u(f)?n.push.apply(n,(0,a.default)(o(f,i(d,t)))):n.push([i(d,t),encodeURIComponent(String(f))])}return n}var c=function(e){if(!(0,s.default)(e))throw new Error("input must be an object");return o(e).map((function(e){return e.join("=")})).join("&")};n.default=c},{"./isPlainObject":"4ImsX"}],"4xi7r":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.storeEventBus=n.storeUserInitial=void 0;var a=r(e("@babel/runtime/helpers/defineProperty")),l=r(e("../utils/classes/EventBus")),s=r(e("../utils/functions/isPlainObject"));function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var o={updateMessenger:!1,userData:{id:null,first_name:"",second_name:"",login:"",email:"",phone:"",display_name:"",avatar:e("../utils/variables").defaultAvatar},chats:[],activeChat:{},searchUserInput:"",activeChatUsers:[],searchUserList:[],activeChatMessages:[],activeChatAvatar:""};n.storeUserInitial=o;var c=o,d=new l.default;n.storeEventBus=d;var f=new Proxy(c,{get:function(e,t){var n=e[t];return"function"==typeof n?n.bind(e):n},set:function(e,t,n){return(0,s.default)(n)?e[t]=i({},n):e[t]=n,console.log(t,"изменился в сторе"),d.emit(t,i({},f)),!0}}),p=f;n.default=p},{"../utils/classes/EventBus":"3ppPn","../utils/functions/isPlainObject":"4ImsX","../utils/variables":"6MRvQ"}],"6MRvQ":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.defaultAvatar=n.resourcesUrl=void 0;n.resourcesUrl="https://ya-praktikum.tech/api/v2/resources";n.defaultAvatar="https://ya-praktikum.tech/api/v2/resources//a16d7fcd-f5fa-468e-afd6-3f9666999c8b/073c838f-acdb-4d84-8edd-1d5313cd02a7_profile.jpg"},{}],"6EZWZ":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("./isPlainObject")),l=r(e("./encodeHTML"));var s=function e(t){var n=t;if("string"==typeof t&&(n=(0,l.default)(t)),Array.isArray(t)&&(n=t.map((function(t){return e(t)}))),(0,a.default)(t))for(var r in n={},t)n[r]=e(t[r]);return n};n.default=s},{"./isPlainObject":"4ImsX","./encodeHTML":"Jfxkn"}],Jfxkn:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e){return"string"!=typeof e?e:e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")};n.default=r},{}],"5kw0O":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e){var t={};return e.forEach((function(e,n){t[n]=e})),t};n.default=r},{}],"6l5XE":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="\n  <div class='form login-wrap'>\n    <h1>Log in</h1>\n    <form>\n      <div data-component='loginInput'></div>\n      <div data-component='passwordInput'></div>\n      <div data-component='submitButton'></div>\n    </form>\n    <div class='pre-link'>Don't have an account? <a data-path='/sign-up' class='link'> Sign up</a></div>\n  </div>"},{}],tOoNo:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.signupProps=n.Signup=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/inherits")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),u=r(e("@babel/runtime/helpers/getPrototypeOf")),i=r(e("../../components/DefaultInput")),o=r(e("../../components/Button")),c=r(e("../../components/Button/index.tmpl")),d=r(e("../../components/DefaultInput/index.tmpl")),f=r(e("../../utils/classes/Validation")),p=e("../../index"),v=r(e("../../modules/Form")),h=r(e("../../controllers/AuthController")),m=r(e("../../utils/functions/getObjFromFormData"));function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var y=new i.default({label:"Email",type:"text",name:"email",errorText:"Wrong email",events:[{type:"blur",element:"input",callback:function(e){var t=e.target;new f.default(t.value).email().isValid?y.setValid():y.setValidError()}}]},d.default),g=new i.default({label:"Login",type:"text",name:"login",errorText:"Wrong login",events:[{type:"blur",element:"input",callback:function(e){var t=e.target;new f.default(t.value).minLength(4).lettersOrNumbers().isValid?g.setValid():g.setValidError()}}]},d.default),k=new i.default({label:"First name",type:"text",name:"first_name",errorText:"Wrong first name",events:[{type:"blur",element:"input",callback:function(e){var t=e.target;new f.default(t.value).minLength(2).onlyLetters().isValid?k.setValid():k.setValidError()}}]},d.default),C=new i.default({label:"Second name",type:"text",name:"second_name",errorText:"Wrong second name",events:[{type:"blur",element:"input",callback:function(e){var t=e.target;new f.default(t.value).minLength(2).onlyLetters().isValid?C.setValid():C.setValidError()}}]},d.default),O=new i.default({label:"Phone number",type:"number",name:"phone",errorText:"Wrong phone number",events:[{type:"blur",element:"input",callback:function(e){var t=e.target;new f.default(t.value).phone().isValid?O.setValid():O.setValidError()}}]},d.default),w=new i.default({label:"Password",type:"password",name:"password",errorText:"Wrong password",events:[{type:"blur",element:"input",callback:function(e){var t=e.target;new f.default(t.value).minLength(6).lettersOrNumbers().isValid?w.setValid():w.setValidError()}}]},d.default),P=new i.default({label:"Password (again)",type:"password",name:"passwordAgain",errorText:"Password mismatch",events:[{type:"blur",element:"input",callback:function(e){var t=e.target,n=new f.default(t.value).minLength(6).lettersOrNumbers().isValid,r=document.querySelector("[name=password]");null!==r&&(n=n&&r.value===t.value),n?P.setValid():P.setValidError()}}]},d.default),_=new o.default({attributes:[{element:"root",disabled:{type:"set",value:!0},className:{type:"add",value:"disabled"}}],type:"submit",text:"Sign up"},c.default),j=function(e){(0,l.default)(n,e);var t=b(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return n}(v.default);n.Signup=j;var B={events:[{type:"submit",element:"form",callback:function(e){e.preventDefault(),h.default.signUp((0,m.default)(new FormData(e.target)))}},{type:"click",element:"[data-path]",callback:function(e){var t=e.target.dataset.path;p.router.go(t)}}],components:{emailInput:y,loginInput:g,firstNameInput:k,secondNameInput:C,phoneInput:O,passwordInput:w,passwordAgainInput:P,submitBtn:_}};n.signupProps=B},{"../../components/DefaultInput":"5xxXy","../../components/Button":"o32bC","../../components/Button/index.tmpl":"30wYB","../../components/DefaultInput/index.tmpl":"7CCL9","../../utils/classes/Validation":"5y01V","../../index":"2VTMI","../../modules/Form":"3PPs5","../../controllers/AuthController":"4WQRY","../../utils/functions/getObjFromFormData":"5kw0O"}],"5n8U4":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="\n  <div class='form signup-wrap'>\n    <h1>Sign up</h1>\n    <form>\n      <div data-component='emailInput'></div>\n      <div data-component='loginInput'></div>\n      <div data-component='firstNameInput'></div>\n      <div data-component='secondNameInput'></div>\n      <div data-component='phoneInput'></div>\n      <div data-component='passwordInput'></div>\n      <div data-component='passwordAgainInput'></div>\n      <div data-component='submitBtn'></div>\n    </form>\n    <div class='pre-link'>Already have an account? <a data-path='/login' class='link'> Log in</a></div>\n  </div>"},{}],"43pLp":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.profileProps=n.Profile=void 0;var a=r(e("@babel/runtime/helpers/defineProperty")),l=r(e("@babel/runtime/helpers/classCallCheck")),s=r(e("@babel/runtime/helpers/createClass")),u=r(e("@babel/runtime/helpers/inherits")),i=r(e("@babel/runtime/helpers/possibleConstructorReturn")),o=r(e("@babel/runtime/helpers/getPrototypeOf")),c=r(e("../../components/ArrowButton/index")),d=r(e("../../components/ArrowButton/index.tmpl")),f=r(e("../../modules/Block/Block")),p=e("../../index"),v=r(e("../../components/popups/FormPopup/index.tmpl")),h=r(e("../../components/DefaultInput")),m=r(e("../../components/DefaultInput/index.tmpl")),b=r(e("../../components/Button")),y=r(e("../../components/Button/index.tmpl")),g=e("../../utils/classes/Validation"),k=r(e("../../controllers/AuthController")),C=r(e("../../store/Store")),O=r(e("../../controllers/UserContoller")),w=r(e("../../utils/functions/getObjFromFormData")),P=r(e("../../components/popups/FormPopup"));function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function B(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}var R=new c.default({attributes:[{element:"root",className:{type:"add",value:"to-left"}},{element:"root","data-path":{type:"set",value:"/"}}],events:[{type:"click",element:"root",callback:function(e){var t=e.target.dataset.path;p.router.go(t)}}]},d.default),D=function(e){(0,u.default)(n,e);var t=B(n);function n(){return(0,l.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"componentDidMount",value:function(){setTimeout((function(){k.default.getUser()}),100)}}]),n}(f.default);n.Profile=D;var x={components:{arrowBtn:R},events:[{type:"click",element:"[data-field]",callback:function(e){!function(e){var t=C.default.userData[e],n="password"===e||"avatar"===e,r={},a=new b.default({type:"submit",text:"confirm edit"},y.default);if(n){if("password"===e){var l=new h.default({label:"Old password",type:"password",name:"oldPassword",errorText:"Wrong ".concat(e),events:[{type:"blur",element:"input",callback:function(t){var n=t.target;(0,g.checkValidationByTemplate)(e,n.value),l.setValid()}}]},m.default),s=new h.default({label:"New password",type:"password",name:"newPassword",errorText:"Wrong ".concat(e),events:[{type:"blur",element:"input",callback:function(t){var n=t.target;(0,g.checkValidationByTemplate)(e,n.value),s.setValid()}}]},m.default);r={formElements:[l,s,a]}}else if("avatar"===e){var u=new h.default({label:e.charAt(0).toUpperCase()+e.slice(1),type:"file",name:e,errorText:"Wrong ".concat(e),events:[{type:"blur",element:"input",callback:function(t){var n=t.target;(0,g.checkValidationByTemplate)(e,n.value),u.setValid()}}]},m.default);r={formElements:[u,a]}}}else{var i=new h.default({label:e.charAt(0).toUpperCase()+e.slice(1),type:"text",value:t,name:e,errorText:"Wrong ".concat(e),events:[{type:"blur",element:"input",callback:function(t){var n=t.target;(0,g.checkValidationByTemplate)(e,n.value),i.setValid()}}]},m.default);r={formElements:[i,a]}}var o=new P.default({title:"Редактировать поле",components:r,events:[{type:"submit",element:"form",callback:function(t){if(t.preventDefault(),n)if("password"===e){var r=(0,w.default)(new FormData(t.target)),a=r.oldPassword,l=r.newPassword;O.default.updateUserPassword(a,l)}else"avatar"===e&&O.default.updateProfileAvatar(new FormData(t.target));else{var s=j(j({},C.default.userData),(0,w.default)(new FormData(t.target)));O.default.updateProfile(s).then((function(){k.default.getUser()})).catch((function(){alert("Не удалось обновить поле ".concat(e))}))}this.destroy()}},{type:"click",element:".close-popup",callback:function(){this.destroy()}}]},v.default);document.body.append(o.getContent())}(e.target.dataset.field)}},{type:"click",element:"[data-logout]",callback:function(){k.default.logout()}}]};n.profileProps=x},{"../../components/ArrowButton/index":"4JYAe","../../components/ArrowButton/index.tmpl":"3VsRK","../../modules/Block/Block":"GBKa8","../../index":"2VTMI","../../components/popups/FormPopup/index.tmpl":"7rZP2","../../components/DefaultInput":"5xxXy","../../components/DefaultInput/index.tmpl":"7CCL9","../../components/Button":"o32bC","../../components/Button/index.tmpl":"30wYB","../../utils/classes/Validation":"5y01V","../../controllers/AuthController":"4WQRY","../../store/Store":"4xi7r","../../controllers/UserContoller":"70rjz","../../utils/functions/getObjFromFormData":"5kw0O","../../components/popups/FormPopup":"2rSr2"}],"4JYAe":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/inherits")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),u=r(e("@babel/runtime/helpers/getPrototypeOf"));function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var o=function(e){(0,l.default)(n,e);var t=i(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return n}(r(e("../../modules/Block/Block")).default);n.default=o},{"../../modules/Block/Block":"GBKa8"}],"3VsRK":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("url:../../../static/img/arrow.svg")),l="\n  <div class='arrow-button'>\n    <img src='".concat(a.default,"' alt=''/>\n  </div>");n.default=l},{"url:../../../static/img/arrow.svg":"4jfWw"}],"4jfWw":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"arrow.586565a4.svg"},{"./bundle-url":"YkqCo"}],YkqCo:[function(e,t,n){"use strict";var r=null;function a(e){return(""+e).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}n.getBundleURL=function(){return r||(r=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return a(e[0])}return"/"}()),r},n.getBaseURL=a,n.getOrigin=function(e){let t=(""+e).match(/(https?|file|ftp):\/\/[^/]+/);if(!t)throw new Error("Origin not found");return t[0]}},{}],"7rZP2":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="\n  <div class='popup-wrap'>\n    <div class='popup'>\n      <div class='close-popup'>+</div>\n      <div class='title'>{{title}}</div>\n      <form>\n        <div data-component='formElements'></div>\n      </form>\n    </div>\n  </div>"},{}],"70rjz":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=r(e("../api/UserApi")),u=r(e("../store/Store")),i=r(e("../utils/functions/deepEncodeHTML")),o=function(){function e(){(0,a.default)(this,e)}return(0,l.default)(e,null,[{key:"updateProfile",value:function(e){return s.default.updateProfile((0,i.default)(JSON.stringify(e)))}},{key:"updateProfileAvatar",value:function(e){s.default.updateProfileAvatar(e)}},{key:"updateUserPassword",value:function(e,t){s.default.updateUserPassword(JSON.stringify((0,i.default)({oldPassword:e,newPassword:t})))}},{key:"getUserById",value:function(e){s.default.getUserById(e)}},{key:"searchUsersByLogin",value:function(e){s.default.searchUsersByLogin(JSON.stringify((0,i.default)({login:e}))).then((function(e){return JSON.parse(e.response)})).then((function(e){u.default.searchUserList=(0,i.default)(e)}))}}]),e}();n.default=o},{"../api/UserApi":"2ZGGD","../store/Store":"4xi7r","../utils/functions/deepEncodeHTML":"6EZWZ"}],"2ZGGD":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=new(r(e("../utils/classes/HTTP")).default)("https://ya-praktikum.tech/api/v2/user"),u=function(){function e(){(0,a.default)(this,e)}return(0,l.default)(e,null,[{key:"updateProfile",value:function(e){return s.put("/profile",{data:e,withCredentials:!0,headers:{"content-type":"application/json"}})}},{key:"updateProfileAvatar",value:function(e){return s.put("/profile/avatar",{data:e,withCredentials:!0})}},{key:"updateUserPassword",value:function(e){return s.put("/password",{data:e,withCredentials:!0,headers:{"content-type":"application/json"}})}},{key:"getUserById",value:function(e){return s.get("/".concat(e),{withCredentials:!0})}},{key:"searchUsersByLogin",value:function(e){return s.post("/search",{data:e,withCredentials:!0,headers:{"content-type":"application/json"}})}}]),e}();n.default=u},{"../utils/classes/HTTP":"1Cfkm"}],"2rSr2":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/inherits")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),u=r(e("@babel/runtime/helpers/getPrototypeOf"));function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var o=function(e){(0,l.default)(n,e);var t=i(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return n}(r(e("../../../modules/Form")).default);n.default=o},{"../../../modules/Form":"3PPs5"}],"7IFjV":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="\n  <div class='profile-wrap'>\n    <div class='sidebar'>\n      <div data-component='arrowBtn'></div>\n    </div>\n    <div class='profile'>\n      <div class='img-wrap'>\n        <img data-field='avatar' src='https://ya-praktikum.tech/api/v2/resources/{{userData.avatar}}' alt='avatar' class='profile-img'>\n      </div>\n      <h3>{{userData.display_name}}</h3>\n      <div class='row'>\n        <p data-field='email' class='field-name'>Email</p>\n        <p class='field-value'>{{userData.email}}</p>\n      </div>\n      <div class='row'>\n        <p data-field='login' class='field-name'>Login</p>\n        <p class='field-value'>{{userData.login}}</p>\n      </div>\n      <div class='row'>\n        <p data-field='password' class='field-name'>Password</p>\n        <p class='field-value'>••••••••••••</p>\n      </div>\n      <div class='row'>\n        <p data-field='first_name' class='field-name'>First name</p>\n        <p class='field-value'>{{userData.first_name}}</p>\n      </div>\n      <div class='row'>\n        <p data-field='second_name' class='field-name'>Second name</p>\n        <p class='field-value'>{{userData.second_name}}</p>\n      </div>\n      <div class='row'>\n        <p data-field='display_name' class='field-name'>Display name</p>\n        <p class='field-value'>{{userData.display_name}}</p>\n      </div>\n      <div class='row'>\n        <p data-field='phone' class='field-name'>Phone number</p>\n        <p class='field-value'>{{userData.phone}}</p>\n      </div>\n      <a data-logout class='link warning'>log out</a>\n    </div>\n  </div>"},{}],"1Mk1Z":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.messengerProps=n.Messenger=void 0;var a=r(e("@babel/runtime/helpers/toConsumableArray")),l=r(e("@babel/runtime/helpers/defineProperty")),s=r(e("@babel/runtime/helpers/classCallCheck")),u=r(e("@babel/runtime/helpers/createClass")),i=r(e("@babel/runtime/helpers/inherits")),o=r(e("@babel/runtime/helpers/possibleConstructorReturn")),c=r(e("@babel/runtime/helpers/getPrototypeOf")),d=r(e("../../modules/Block/Block")),f=r(e("../../components/ArrowButton")),p=r(e("../../components/ArrowButton/index.tmpl")),v=r(e("../../components/DefaultInput")),h=r(e("../../components/DefaultInput/index.tmpl")),m=r(e("../../components/searchInput/index.tmpl")),b=e("../../index"),y=r(e("../../controllers/ChatsController")),g=r(e("../../components/popups/FormPopup")),k=r(e("../../components/popups/FormPopup/index.tmpl")),C=r(e("../../utils/functions/getObjFromFormData")),O=r(e("../../store/Store")),w=r(e("../../components/Button")),P=r(e("../../components/Button/index.tmpl")),_=r(e("../../components/ChatItem")),j=r(e("../../components/ChatItem/index.tmpl")),B=r(e("../../utils/classes/Templator")),R=r(e("../../api/ChatsApi")),D=r(e("../../api/MessageApi")),x=r(e("../../components/Messages")),M=r(e("../../components/popups/ChatUserListPopup")),E=r(e("../../utils/functions/encodeHTML")),S=r(e("../../utils/functions/deepEncodeHTML"));function L(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?L(Object(n),!0).forEach((function(t){(0,l.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var a=(0,c.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,o.default)(this,n)}}var T=new f.default({},p.default),V=function(e){(0,i.default)(n,e);var t=I(n);function n(){return(0,s.default)(this,n),t.apply(this,arguments)}return(0,u.default)(n,[{key:"sendMessage",value:function(e){this.props.socket.send(JSON.stringify({content:(0,E.default)(e),type:"message"}))}},{key:"componentDidMount",value:function(){y.default.getChats(0,20)}},{key:"render",value:function(){var e=this.props.chats.map((function(e){return new _.default({},(0,j.default)(e))}));return B.default.getCompiledChildren(this._meta.tmpl,U(U({},this.props),{},{activeChatAvatar:O.default.activeChat.avatar?"":"empty",components:U(U({},this.props.components),{},{chatList:e})}))}},{key:"afterRender",value:function(){var e;null!==(e=O.default.activeChat)&&void 0!==e&&e.id||(this.element.querySelector(".empty-chat").classList.remove("hidden"),this.element.querySelector(".chat-content-wrap").classList.add("hidden"))}}]),n}(d.default);n.Messenger=V;var F={chats:[],chatAvatarClass:"empty",events:[{type:"click",element:"[data-path]",callback:function(e){var t=e.target.dataset.path;b.router.go(t)}},{type:"click",element:".settings-btn",callback:function(){document.querySelector(".settings-popup").classList.toggle("hidden")}},{type:"click",element:".add-chat-btn",callback:function(){var e,t,n;e=new w.default({type:"submit",text:"create"},P.default),t=new v.default({label:"Chat name",type:"text",name:"title",errorText:"Wrong chat name",events:[{type:"blur",element:"input",callback:function(){t.setValid()}}]},h.default),n=new g.default({title:"Create chat",components:{formElements:[t,e]},events:[{type:"submit",element:"form",callback:function(e){e.preventDefault(),y.default.createChat((0,C.default)(new FormData(e.target)).title),this.destroy()}},{type:"click",element:".close-popup",callback:function(){this.destroy()}}]},k.default),document.body.append(n.getContent())}},{type:"click",element:".controls .arrow-button",callback:function(){this.sendMessage(this.element.querySelector(".controls input").value),this.element.querySelector(".controls input").value="",y.default.getChats()}},{type:"click",element:"[data-action]",callback:function(e){var t,n,r,a=e.currentTarget.dataset.action;"deleteChat"===a?(t=O.default.activeChat,n=new w.default({type:"submit",text:"delete"},P.default),r=new g.default({title:"Confirm deleting chat ".concat(t.title),components:{formElements:[n]},events:[{type:"submit",element:"form",callback:function(e){e.preventDefault(),y.default.deleteChat(t.id),this.destroy()}},{type:"click",element:".close-popup",callback:function(){this.destroy()}}]},k.default),document.body.append(r.getContent())):"chatAvatarUpdate"===a?function(e){var t=new w.default({type:"submit",text:"update"},P.default),n=new v.default({type:"hidden",name:"chatId",value:e},h.default),r=new v.default({label:"",type:"file",name:"avatar"},h.default),a=new g.default({title:"Update chat avatar",components:{formElements:[n,r,t]},events:[{type:"submit",element:"form",callback:function(e){e.preventDefault(),y.default.updateChatAvatar(new FormData(e.target)),this.destroy()}},{type:"click",element:".close-popup",callback:function(){this.destroy()}}]},k.default);document.body.append(a.getContent())}(O.default.activeChat.id):"chatUserList"===a&&document.body.append(M.default.getContent())}},{type:"click",element:".chat",callback:function(e){var t=this,n=e.currentTarget.dataset.id;void 0!==n&&+n!==O.default.activeChat.id&&(this.props.socket&&(this.props.socket.close(),O.default.activeChatMessages=[]),O.default.activeChat=O.default.chats.find((function(e){return e.id===+n})),y.default.getChatUsersById(+n),R.default.getToken(+n).then((function(e){var r,l=JSON.parse(e.response).token,s=D.default.startChat(O.default.userData.id,+n,l);s.addEventListener("open",(function(){r=setInterval((function(){s.send(JSON.stringify({type:"ping"}))}),2e3),y.default.getNewMessagesCount(O.default.activeChat.id).then((function(e){return JSON.parse(e.response)})).then((function(e){s.send(JSON.stringify({content:e.unread_count,type:"get old"}))}))})),s.onmessage=function(e){var t,n=(0,S.default)(JSON.parse(e.data));"pong"!==n.type&&((t=Array.isArray(n)?O.default.activeChatMessages=[].concat((0,a.default)(O.default.activeChatMessages),(0,a.default)(n)):O.default.activeChatMessages=[].concat((0,a.default)(O.default.activeChatMessages),[n])).sort((function(e,t){return+new Date(e.time)-+new Date(t.time)})),O.default.activeChatMessages=t)},s.addEventListener("close",(function(e){e.wasClean?console.log("Соединение закрыто чисто"):console.log("Обрыв соединения"),clearInterval(r),console.log("Код: ".concat(e.code," | Причина: ").concat(e.reason))})),t.setProps({socket:s})})),this.setProps({activeChatAvatar:O.default.activeChat.avatar?"":"empty",attributes:[{element:".empty-chat",className:{type:"add",value:"hidden"}},{element:".chat-content-wrap",className:{type:"remove",value:"hidden"}}]}))}}],components:{messages:x.default,searchInput:new v.default({},m.default),messageInput:new v.default({attributes:[{element:"root",className:{type:"add",value:"fullwidth"}}]},h.default),arrowBtn:T}};n.messengerProps=F},{"../../modules/Block/Block":"GBKa8","../../components/ArrowButton":"4JYAe","../../components/ArrowButton/index.tmpl":"3VsRK","../../components/DefaultInput":"5xxXy","../../components/DefaultInput/index.tmpl":"7CCL9","../../components/searchInput/index.tmpl":"4Ykec","../../index":"2VTMI","../../controllers/ChatsController":"2EryD","../../components/popups/FormPopup":"2rSr2","../../components/popups/FormPopup/index.tmpl":"7rZP2","../../utils/functions/getObjFromFormData":"5kw0O","../../store/Store":"4xi7r","../../components/Button":"o32bC","../../components/Button/index.tmpl":"30wYB","../../components/ChatItem":"7coN3","../../components/ChatItem/index.tmpl":"3KWa8","../../utils/classes/Templator":"6VyJz","../../api/ChatsApi":"5O2bE","../../api/MessageApi":"6LZZT","../../components/Messages":"2M7ZJ","../../components/popups/ChatUserListPopup":"2TlYL","../../utils/functions/encodeHTML":"Jfxkn","../../utils/functions/deepEncodeHTML":"6EZWZ"}],"4Ykec":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("url:../../../static/img/search.svg")),l="\n  <div class='input-wrap'>\n    <img class='search-icon' src='".concat(a.default,"' alt=''>\n    <span class='label'>{{label}}</span>\n    <div class=\"input-inner-wrap\">\n      <input data-valid='false' name='{{name}}' class='input search' type='{{type}}'/>\n    </div>\n    <span data-validation-error class='error'>{{errorText}}</span>\n  </div>");n.default=l},{"url:../../../static/img/search.svg":"5V8e1"}],"5V8e1":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"search.2964ddfb.svg"},{"./bundle-url":"YkqCo"}],"2EryD":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=r(e("../api/ChatsApi")),u=r(e("../store/Store")),i=r(e("../utils/functions/deepEncodeHTML")),o=function(){function e(){(0,a.default)(this,e)}return(0,l.default)(e,null,[{key:"getChats",value:function(e,t,n){var r={};e&&(r.offset=e),e&&(r.limit=t),e&&(r.title=n),s.default.getChats(r).then((function(e){var t,n=(0,i.default)(JSON.parse(e.response));u.default.chats=n,null!==(t=u.default.activeChat)&&void 0!==t&&t.id&&(u.default.activeChat=n.find((function(e){return e.id===u.default.activeChat.id})))}))}},{key:"createChat",value:function(t){s.default.createChat(JSON.stringify((0,i.default)({title:t}))).then((function(){e.getChats()}))}},{key:"deleteChat",value:function(t){return s.default.deleteChat(JSON.stringify((0,i.default)({chatId:t}))).then((function(){u.default.activeChat={},e.getChats()}))}},{key:"getChatUsersById",value:function(e,t){s.default.getChatUsersById(e,t).then((function(e){u.default.activeChatUsers=(0,i.default)(JSON.parse(e.response))}))}},{key:"getNewMessagesCount",value:function(e){return s.default.getNewMessagesCount(e)}},{key:"updateChatAvatar",value:function(t){return s.default.updateChatAvatar(t).then((function(){u.default.updateMessenger=!u.default.updateMessenger,e.getChats()}))}},{key:"addUsersToChatById",value:function(t,n){s.default.addUsersToChatById(JSON.stringify((0,i.default)({chatId:t,users:n}))).then((function(){alert("Пользователь добавлен"),e.getChats(),e.getChatUsersById(t)}))}},{key:"deleteUserFromChat",value:function(t,n){return s.default.deleteUserFromChat(JSON.stringify((0,i.default)({chatId:t,users:n}))).then((function(){e.getChats(),e.getChatUsersById(t)}))}}]),e}();n.default=o},{"../api/ChatsApi":"5O2bE","../store/Store":"4xi7r","../utils/functions/deepEncodeHTML":"6EZWZ"}],"5O2bE":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/regenerator")),l=r(e("@babel/runtime/helpers/asyncToGenerator")),s=r(e("@babel/runtime/helpers/classCallCheck")),u=r(e("@babel/runtime/helpers/createClass")),i=new(r(e("../utils/classes/HTTP")).default)("https://ya-praktikum.tech/api/v2/chats"),o=function(){function e(){(0,s.default)(this,e)}var t,n,r,o,c,d,f,p,v;return(0,u.default)(e,null,[{key:"getChats",value:(v=(0,l.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.get("/",{data:t,withCredentials:!0}));case 1:case"end":return e.stop()}}),e)}))),function(e){return v.apply(this,arguments)})},{key:"createChat",value:(p=(0,l.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.post("/",{data:t,withCredentials:!0,headers:{"content-type":"application/json"}}));case 1:case"end":return e.stop()}}),e)}))),function(e){return p.apply(this,arguments)})},{key:"deleteChat",value:(f=(0,l.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.delete("/",{data:t,withCredentials:!0,headers:{"content-type":"application/json"}}));case 1:case"end":return e.stop()}}),e)}))),function(e){return f.apply(this,arguments)})},{key:"getChatUsersById",value:(d=(0,l.default)(a.default.mark((function e(t,n){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.get("/".concat(t,"/users"),{data:n,withCredentials:!0}));case 1:case"end":return e.stop()}}),e)}))),function(e,t){return d.apply(this,arguments)})},{key:"getNewMessagesCount",value:(c=(0,l.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.get("/new/".concat(t),{withCredentials:!0}));case 1:case"end":return e.stop()}}),e)}))),function(e){return c.apply(this,arguments)})},{key:"updateChatAvatar",value:(o=(0,l.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.put("/avatar",{data:t,withCredentials:!0}));case 1:case"end":return e.stop()}}),e)}))),function(e){return o.apply(this,arguments)})},{key:"getToken",value:(r=(0,l.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.post("/token/".concat(t),{withCredentials:!0}));case 1:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"addUsersToChatById",value:(n=(0,l.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.put("/users",{data:t,withCredentials:!0,headers:{"content-type":"application/json"}}));case 1:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"deleteUserFromChat",value:(t=(0,l.default)(a.default.mark((function e(t){return a.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",i.delete("/users",{data:t,withCredentials:!0,headers:{"content-type":"application/json"}}));case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})}]),e}();n.default=o},{"../utils/classes/HTTP":"1Cfkm"}],"7coN3":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/inherits")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),u=r(e("@babel/runtime/helpers/getPrototypeOf"));function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var o=function(e){(0,l.default)(n,e);var t=i(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return n}(r(e("../../modules/Block/Block")).default);n.default=o},{"../../modules/Block/Block":"GBKa8"}],"3KWa8":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=e("../../utils/variables"),a=function(e){var t,n,a,l=e.id,s=e.avatar,u=e.title,i=e.unread_count,o=e.last_message;null!=o&&null!==(t=o.user)&&void 0!==t&&t.display_name?n="<span class='own-msg'>".concat(null==o||null===(a=o.user)||void 0===a?void 0:a.display_name," :</span><span>").concat(o.content,"</span>"):n="<span class='own-msg'>Нет сообщений</span>";var c=null!=o&&o.time?new Date(o.time).toLocaleTimeString().slice(0,-3):"";return'\n  <div data-id="'.concat(l,"\" class='chat'>\n    <div class='img ").concat(s||"empty","'>\n      <img src=\"").concat(r.resourcesUrl).concat(s,"\" alt=\"\">\n    </div>\n    <div class='content'>\n      <div class='name'>").concat(u,"</div>\n      <div class='last-msg'> \n        ").concat(n,"\n      </div>\n      <div class='unread-msg-count-wrap'>").concat(i,"</div>\n      <div class='last-msg-date'>").concat(c,"</div>\n    </div>\n  </div>")};n.default=a},{"../../utils/variables":"6MRvQ"}],"6LZZT":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=function(){function e(){(0,a.default)(this,e)}return(0,l.default)(e,null,[{key:"startChat",value:function(e,t,n){return new WebSocket("wss://ya-praktikum.tech/ws/chats/".concat(e,"/").concat(t,"/").concat(n))}}]),e}();n.default=s},{}],"2M7ZJ":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/defineProperty")),l=r(e("@babel/runtime/helpers/classCallCheck")),s=r(e("@babel/runtime/helpers/createClass")),u=r(e("@babel/runtime/helpers/inherits")),i=r(e("@babel/runtime/helpers/possibleConstructorReturn")),o=r(e("@babel/runtime/helpers/getPrototypeOf")),c=r(e("../../store/Store")),d=r(e("../../modules/Block/Block")),f=r(e("../../utils/classes/Templator")),p=r(e("./index.tmpl"));function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}var b=new(function(e){(0,u.default)(n,e);var t=m(n);function n(){return(0,l.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props.activeChatMessages,t=new d.default({},"<div>".concat(e.map((function(e){return(0,p.default)(e)})).join(),"</div>"));return f.default.getCompiledChildren(this._meta.tmpl,h(h({},this.props),{},{components:h(h({},this.props.components),{},{messages:t})}))}}]),n}(d.default))({activeChatMessages:c.default.activeChatMessages},'<div><div data-component="messages"></div></div>');n.default=b},{"../../store/Store":"4xi7r","../../modules/Block/Block":"GBKa8","../../utils/classes/Templator":"6VyJz","./index.tmpl":"5VCXP"}],"5VCXP":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("../../store/Store"));n.default=function(e){var t=e.id,n=e.time,r=e.user_id,l=e.content,s=+r===a.default.userData.id?"own":"other",u=new Date(n).toLocaleTimeString().slice(0,-3);return"\n    <div data-id='".concat(t,"' class='message ").concat(s,"'>\n      <p class='text'>\n        ").concat(l,"\n      </p>\n      <div class='info'>\n        <div class='time'>").concat(u,"</div>\n      </div>\n    </div>")}},{"../../store/Store":"4xi7r"}],"2TlYL":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/defineProperty")),l=r(e("@babel/runtime/helpers/classCallCheck")),s=r(e("@babel/runtime/helpers/createClass")),u=r(e("@babel/runtime/helpers/inherits")),i=r(e("@babel/runtime/helpers/possibleConstructorReturn")),o=r(e("@babel/runtime/helpers/getPrototypeOf")),c=r(e("../../../modules/Form")),d=e("../../../utils/variables"),f=r(e("../../CloseCircleButton")),p=r(e("../../CloseCircleButton/index.tmpl")),v=r(e("../../../store/Store")),h=r(e("../../../modules/Block/Block")),m=r(e("../../PlusCircleButton")),b=r(e("../../PlusCircleButton/index.tmpl")),y=r(e("../../../utils/functions/getObjFromFormData")),g=r(e("./index.tmpl")),k=r(e("../../../utils/classes/Templator")),C=r(e("../../../controllers/ChatsController")),O=r(e("../ChatUserAddPopup"));function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}var j=function(e){var t=e.id,n=e.first_name,r=e.second_name,a=e.avatar;return'<div data-id="'.concat(t,'" class="user-item">\n                          <div  class="user-info">\n                            <div class="user-avatar ').concat(a||"empty",'"><img src="').concat(d.resourcesUrl).concat(a||"",'" alt=""></div>\n                            <div>').concat(n," ").concat(r,'</div>\n                          </div>\n                          <div data-component="closeCircleButton"></div>\n                        </div>')},B=v.default.activeChatUsers.map((function(e){return new h.default({components:{closeCircleButton:new f.default({events:[{type:"click",element:"root",callback:function(e){var t=e.currentTarget.parentNode.dataset.id;C.default.deleteUserFromChat(v.default.activeChat.id,[+t])}}],attributes:[{element:"root",className:{type:"add",value:"delete-user-btn"}}]},p.default)}},j(e))})),R=new m.default({attributes:[{element:"root",className:{type:"add",value:"add-user-btn"}}]},b.default),D=new(function(e){(0,u.default)(n,e);var t=_(n);function n(){return(0,l.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props.activeChatUsers.map((function(e){return new h.default({components:{closeCircleButton:new f.default({events:[{type:"click",element:"root",callback:function(e){var t=e.currentTarget.parentNode.dataset.id;C.default.deleteUserFromChat(v.default.activeChat.id,[+t])}}],attributes:[{element:"root",className:{type:"add",value:"delete-user-btn"}}]},p.default)}},j(e))}));return k.default.getCompiledChildren(this._meta.tmpl,P(P({},this.props),{},{components:P(P({},this.props.components),{},{userList:e})}))}}]),n}(c.default))({activeChatUsers:v.default.activeChatUsers,title:"Список пользователей",components:{userList:B,plusBtn:R},attributes:[{element:"root",className:{type:"add",value:"user-list-popup"}}],events:[{type:"submit",element:"form",callback:function(e){e.preventDefault();var t=e.target,n=new FormData(t);console.log((0,y.default)(n)),this.destroy()}},{type:"click",element:".close-popup",callback:function(){this.destroy()}},{type:"click",element:".add-user-btn",callback:function(){document.body.append(O.default.getContent()),this.destroy()}}]},g.default);n.default=D},{"../../../modules/Form":"3PPs5","../../../utils/variables":"6MRvQ","../../CloseCircleButton":"Vi0GF","../../CloseCircleButton/index.tmpl":"6Eeh6","../../../store/Store":"4xi7r","../../../modules/Block/Block":"GBKa8","../../PlusCircleButton":"3deP6","../../PlusCircleButton/index.tmpl":"1bzn7","../../../utils/functions/getObjFromFormData":"5kw0O","./index.tmpl":"6ka8h","../../../utils/classes/Templator":"6VyJz","../../../controllers/ChatsController":"2EryD","../ChatUserAddPopup":"33Q4c"}],Vi0GF:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/inherits")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),u=r(e("@babel/runtime/helpers/getPrototypeOf"));function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var o=function(e){(0,l.default)(n,e);var t=i(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return n}(r(e("../../modules/Block/Block")).default);n.default=o},{"../../modules/Block/Block":"GBKa8"}],"6Eeh6":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("url:../../../static/img/close_circle.svg")),l="\n  <div class='circle-button'>\n    <img src='".concat(a.default,"' alt=''/>\n  </div>");n.default=l},{"url:../../../static/img/close_circle.svg":"qTu1n"}],qTu1n:[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"close_circle.eef96e8a.svg"},{"./bundle-url":"YkqCo"}],"3deP6":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/inherits")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),u=r(e("@babel/runtime/helpers/getPrototypeOf"));function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var o=function(e){(0,l.default)(n,e);var t=i(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return n}(r(e("../../modules/Block/Block")).default);n.default=o},{"../../modules/Block/Block":"GBKa8"}],"1bzn7":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("url:../../../static/img/plus_circle.svg")),l="\n  <div class='circle-button'>\n    <img src='".concat(a.default,"' alt=''/>\n  </div>");n.default=l},{"url:../../../static/img/plus_circle.svg":"I7XAS"}],I7XAS:[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"plus_circle.d1112072.svg"},{"./bundle-url":"YkqCo"}],"6ka8h":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="\n  <div class='popup-wrap'>\n    <div class='popup'>\n      <div class='close-popup'>+</div>\n      <div class=\"title-wrap\">\n        <div class='title'>{{title}}</div>\n        <div data-component=\"plusBtn\"></div>\n      </div>\n      <form>\n        <div data-component='userList'></div>\n      </form>\n    </div>\n  </div>"},{}],"33Q4c":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/defineProperty")),l=r(e("@babel/runtime/helpers/classCallCheck")),s=r(e("@babel/runtime/helpers/createClass")),u=r(e("@babel/runtime/helpers/inherits")),i=r(e("@babel/runtime/helpers/possibleConstructorReturn")),o=r(e("@babel/runtime/helpers/getPrototypeOf")),c=r(e("../../../modules/Form")),d=r(e("../../DefaultInput")),f=r(e("../../../controllers/UserContoller")),p=r(e("../../../store/Store")),v=r(e("../../searchInput/index.tmpl")),h=e("../../../utils/variables"),m=r(e("../../../modules/Block/Block")),b=r(e("../../../utils/functions/getObjFromFormData")),y=r(e("./index.tmpl")),g=r(e("../../../utils/classes/Templator")),k=r(e("../../Button")),C=r(e("../../Button/index.tmpl")),O=r(e("../../../controllers/ChatsController"));function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach((function(t){(0,a.default)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,o.default)(e);if(t){var a=(0,o.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,i.default)(this,n)}}var j=new d.default({type:"text",name:"search",label:"Поиск пользователей",events:[{value:p.default.searchUserInput,type:"input",element:"input",callback:function(e){var t=e.target;f.default.searchUsersByLogin(t.value)}}]},v.default),B=new k.default({type:"submit",text:"добавить выбранных"},C.default),R=function(e){var t=e.id,n=e.first_name,r=e.second_name,a=e.avatar;return'<div class="user-item">\n            <div class="user-info">\n              <div class="user-avatar"><img src="'.concat(h.resourcesUrl).concat(a,'" alt=""></div>\n              <div>').concat(n," ").concat(r,'</div>\n            </div>\n            <input name="user-').concat(t,'" type="checkbox">\n          </div>')},D=p.default.searchUserList.map((function(e){return new m.default({},R(e))})),x=new(function(e){(0,u.default)(n,e);var t=_(n);function n(){return(0,l.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"render",value:function(){var e=this.props.searchUserList.map((function(e){return new m.default({},R(e))}));return g.default.getCompiledChildren(this._meta.tmpl,P(P({},this.props),{},{components:P(P({},this.props.components),{},{userList:e})}))}},{key:"afterRender",value:function(){this.element.querySelector("input").focus()}}]),n}(c.default))({searchUserList:[],title:"Добавить пользователей",components:{searchInput:j,userList:D,submitBtn:B},events:[{type:"submit",element:"form",callback:function(e){e.preventDefault();var t=e.target,n=new FormData(t),r=[];Object.keys((0,b.default)(n)).forEach((function(e){e.includes("user-")&&r.push(+e.slice(5))})),O.default.addUsersToChatById(p.default.activeChat.id,r)}},{type:"click",element:".close-popup",callback:function(){p.default.searchUserList=[],p.default.searchUserInput="",this.destroy()}}]},y.default);n.default=x},{"../../../modules/Form":"3PPs5","../../DefaultInput":"5xxXy","../../../controllers/UserContoller":"70rjz","../../../store/Store":"4xi7r","../../searchInput/index.tmpl":"4Ykec","../../../utils/variables":"6MRvQ","../../../modules/Block/Block":"GBKa8","../../../utils/functions/getObjFromFormData":"5kw0O","./index.tmpl":"7pp5C","../../../utils/classes/Templator":"6VyJz","../../Button":"o32bC","../../Button/index.tmpl":"30wYB","../../../controllers/ChatsController":"2EryD"}],"7pp5C":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="\n  <div class='popup-wrap'>\n    <div class='popup'>\n      <div class='close-popup'>+</div>\n      <div class='title'>{{title}}</div>\n      <form>\n        <div data-component='searchInput'></div>\n        <div data-component='userList'></div>\n        <div data-component='submitBtn'></div>\n      </form>\n    </div>\n  </div>"},{}],d2HmX:[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("url:../../../static/img/plus.svg")),l=r(e("url:../../../static/img/dot-btn.svg")),s=r(e("url:../../../static/img/attach.svg")),u=r(e("url:../../../static/img/user-icon.svg")),i=r(e("url:../../../static/img/camera.svg")),o=r(e("url:../../../static/img/trash.svg")),c=r(e("url:../../../static/img/settings.svg")),d=e("../../utils/variables"),f="\n  <div class='chat-wrap'>\n    <div class='chat-list-wrap'>\n      <div class='controls-wrap'>\n        <button class='img-btn'>\n          <img data-path='/settings' src='".concat(c.default,"' alt='' />\n        </button>\n        <div class='search-input-wrap'>\n          <div data-component='searchInput'></div>\n        </div>\n        <button class='add-chat-btn img-btn'>\n          <img src='").concat(a.default,"' alt='' />\n        </button>\n      </div>\n      <div class='chat-list'>\n        <div data-component='chatList'></div>\n      </div>\n    </div>\n    <div class='chat-content-wrap hidden'>\n      <div class='header'>\n        <div class='chat-header'>\n          <div class='chat-img {{activeChatAvatar}}'><img src=\"").concat(d.resourcesUrl,'{{activeChat.avatar}}" alt=""></div>\n          <div class=\'chat-name\'>{{activeChat.title}}</div>\n        </div>\n        <button class=\'settings-btn img-btn\'>\n          <div class="settings-popup hidden">\n             <div data-action="chatUserList" class="item">\n               <div class="img-btn"><img src=').concat(u.default,' alt=""></div>\n               <div>Список пользователей</div>\n            </div>\n             <div data-action="chatAvatarUpdate" class="item">\n               <div class="img-btn"><img src=').concat(i.default,' alt=""></div>\n               <div>Изменить аватар чата</div>\n            </div>\n             <div data-action="deleteChat" class="item">\n               <div class="img-btn"><img src=').concat(o.default,' alt=""></div>\n               <div>Удалить чат</div>\n            </div>\n          </div>\n          <img src=\'').concat(l.default,"' alt='' />\n        </button>\n      </div>\n      <div class='content'>\n        <div class='messages'>\n          <div data-component='messages'></div>\n        </div>\n      </div>\n      <div class='controls'>\n        <button class='attach-btn img-btn'>\n          <img src='").concat(s.default,"' alt='' />\n        </button>\n        <div data-component='messageInput'></div>\n        <div data-component='arrowBtn'></div>\n      </div>\n    </div>\n    <div class='empty-chat'>Select chat to start messaging</div>\n  </div>");n.default=f},{"url:../../../static/img/plus.svg":"1Xk0Q","url:../../../static/img/dot-btn.svg":"5d56m","url:../../../static/img/attach.svg":"6tb6D","url:../../../static/img/user-icon.svg":"62eOR","url:../../../static/img/camera.svg":"7IV6V","url:../../../static/img/trash.svg":"17XoD","url:../../../static/img/settings.svg":"3buKJ","../../utils/variables":"6MRvQ"}],"1Xk0Q":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"plus.094c9006.svg"},{"./bundle-url":"YkqCo"}],"5d56m":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"dot-btn.0efa3fab.svg"},{"./bundle-url":"YkqCo"}],"6tb6D":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"attach.582e70ed.svg"},{"./bundle-url":"YkqCo"}],"62eOR":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"user-icon.06e9290a.svg"},{"./bundle-url":"YkqCo"}],"7IV6V":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"camera.e6da0634.svg"},{"./bundle-url":"YkqCo"}],"17XoD":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"trash.c7952315.svg"},{"./bundle-url":"YkqCo"}],"3buKJ":[function(e,t,n){t.exports=e("./bundle-url").getBundleURL()+"settings.99d08653.svg"},{"./bundle-url":"YkqCo"}],"1zU4o":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/inherits")),s=r(e("@babel/runtime/helpers/possibleConstructorReturn")),u=r(e("@babel/runtime/helpers/getPrototypeOf"));function i(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var a=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var o=function(e){(0,l.default)(n,e);var t=i(n);function n(){return(0,a.default)(this,n),t.apply(this,arguments)}return n}(r(e("../../modules/Block/Block")).default);n.default=o},{"../../modules/Block/Block":"GBKa8"}],"6FZfd":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default="\n  <div class='error-page-wrap'>\n    <h1 class='title'>{{error.code}}</h1>\n    <h3 class='message'>{{error.message}}</h3>\n    <a class='link'>Назад к чатам</a>\n  </div>"},{}],"5iJih":[function(){},{}],"2GTux":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=r(e("@babel/runtime/helpers/defineProperty")),u=r(e("./Route")),i=r(e("../../controllers/AuthController")),o=function(){function e(t){if((0,a.default)(this,e),(0,s.default)(this,"routes",[]),(0,s.default)(this,"history",window.history),(0,s.default)(this,"_currentRoute",null),(0,s.default)(this,"_rootQuery",""),e.__instance)return e.__instance;this._rootQuery=t,e.__instance=this}return(0,l.default)(e,[{key:"use",value:function(e,t,n){var r=new u.default(e,t,{rootQuery:this._rootQuery},n);return this.routes.push(r),this}},{key:"getCurrentRoute",value:function(){return this._currentRoute}},{key:"start",value:function(){var e=this;window.onpopstate=function(t){if(null!==t.currentTarget){var n=t.currentTarget;e._onRoute(n.location.pathname)}},this._onRoute(window.location.pathname)}},{key:"_onRoute",value:function(e){var t,n=this,r=null!==(t=this.getRoute(e))&&void 0!==t?t:this.getRoute("errorPage");this._currentRoute&&this._currentRoute.leave(),r.isProtected?i.default.checkUserLoggedIn().then((function(){n._currentRoute=r,r.render()})).catch((function(){n.go("/login")})):(this._currentRoute=r,r.render())}},{key:"go",value:function(e){this.history.pushState({},"",e),this._onRoute(e)}},{key:"back",value:function(){this.history.back()}},{key:"forward",value:function(){this.history.forward()}},{key:"getRoute",value:function(e){return this.routes.find((function(t){return t.pathname===e}))}}]),e}();(0,s.default)(o,"__instance",void 0);var c=o;n.default=c},{"./Route":"3sXva","../../controllers/AuthController":"4WQRY"}],"3sXva":[function(e,t,n){"use strict";var r=e("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var a=r(e("@babel/runtime/helpers/classCallCheck")),l=r(e("@babel/runtime/helpers/createClass")),s=r(e("@babel/runtime/helpers/defineProperty")),u=r(e("../functions/renderDom")),i=function(){function e(t,n,r,l){(0,a.default)(this,e),(0,s.default)(this,"pathname",void 0),(0,s.default)(this,"_block",void 0),(0,s.default)(this,"_props",void 0),(0,s.default)(this,"init",!1),(0,s.default)(this,"isProtected",void 0),this.pathname=t,this._block=n,this._props=r,this.isProtected=l}return(0,l.default)(e,[{key:"navigate",value:function(e){e===this.pathname&&(this.pathname=e,this.render())}},{key:"leave",value:function(){this._block.destroy()}},{key:"render",value:function(){if(!this.init)return(0,u.default)(this._props.rootQuery,this._block),void(this.init=!0);this._block.create(),(0,u.default)(this._props.rootQuery,this._block)}}]),e}();n.default=i},{"../functions/renderDom":"5vcdF"}],"5vcdF":[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(e,t){document.querySelector(e).append(t.getContent())};n.default=r},{}]},["2VTMI"],"2VTMI");
//# sourceMappingURL=index.d281444f.js.map
